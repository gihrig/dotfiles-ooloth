###########
# General #
###########

# Make clear faster to type
alias c='clear'

#######
# bat #
#######

# Replace cat with bat
alias cat='bat --paging=never'

######
# cd #
######

# Jump to common directories
alias cdh='cd $HOME'
alias cdo='cd $HOME/Repos/ooloth'
alias cdd='cd $HOME/Repos/ooloth/dotfiles'
alias cdm='cd $HOME/Repos/ooloth/michaeluloth.com'

# Up we go
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias .....='cd ../../../..'

# List directory contents + activate python venv (if any) after moving
chpwd() {
   ls

   # On work laptop only
   if [ -d "$HOME/Repos/recursionpharma" ]; then
     va
   fi
}

##########
# ecobee #
##########

alias y='yarn install'
alias yd='y && yarn start:dev'
alias yb='y && yarn build'
alias ys='yb && yarn serve'
alias yc='yarn clean'
alias yt='yarn test:dev'
alias ytu='yarn test:update'
ytp() {
   yt --testPathPattern=$1
}

#######
# exa #
#######

# Replace ls with exa
alias ls='exa --all --group-directories-first'                             # top level dir + files
alias ld='exa --all --git --group-directories-first --header --long'       # top level details
alias lt='exa --all --git-ignore --group-directories-first -I .git --tree --level=1' # file tree (all levels)
alias lt2='lt --level=2'                                                   # file tree (2 levels only)
alias lt3='lt --level=3'                                                   # file tree (3 levels only)
alias lt4='lt --level=4'                                                   # file tree (4 levels only)

#######
# fnm #
#######

# Replace nvm with fnm
alias nvm='fnm'

eval "$(fnm env --use-on-cd)"

############
# Homebrew #
############

# Update homebrew
alias bu='brew upgrade && brew update && brew cleanup && brew doctor'

# Add Homebrew's executable directory to front of PATH
export PATH=/usr/local/bin:$PATH

#########
# kitty #
#########

# Alias kitty's ssh kitten
alias s="kitty +kitten ssh"

############
# LunarVim #
############

export EDITOR='lvim'

# Replace vim with LunarVim
alias vim='lvim'
alias v='vim'

# Add lvim location to PATH
export PATH=$HOME/.local/bin:$PATH

# Add cargo to PATH
export PATH="$HOME/.cargo/bin:$PATH"

#############
# Recursion #
#############

# Only add the following on my work laptop
if [ -d "$HOME/Repos/recursionpharma" ]; then

   # Aliases
   alias cdr='cd $HOME/Repos/recursionpharma'
   alias cdpa='cd $HOME/Repos/recursionpharma/dash-phenoapp-v2'
   alias cdpab='cd $HOME/Repos/recursionpharma/dash-phenoapp-v2/phenoapp'
   alias cdpaf='cd $HOME/Repos/recursionpharma/dash-phenoapp-v2/react-app'
   alias cdpr='cd $HOME/Repos/recursionpharma/phenoreader'
   alias cdps='cd $HOME/Repos/recursionpharma/phenoservice-api'
   alias cdpc='cd $HOME/Repos/recursionpharma/phenoservice-consumer'

   va() {
      if [[ $PWD =~ "recursionpharma/dash-phenoapp-v2" ]]; then
         pyenv shell dash-phenoapp-v2
      elif [[ $PWD =~ "recursionpharma/eng-onboarding" ]]; then
         pyenv shell eng-onboarding
      elif [[ $PWD =~ "recursionpharma/phenoreader" ]]; then
         pyenv shell phenoreader
      elif [[ $PWD =~ "recursionpharma/phenoservice-api" ]]; then
         pyenv shell phenoservice-api
      elif [[ $PWD =~ "recursionpharma/phenoservice-consumer" ]]; then
         pyenv shell phenoservice-consumer
      else
         pyenv shell system
      fi
   }

   # Confluent-Kafka
   # TODO: update these whenever I run brew update
   export C_INCLUDE_PATH=/opt/homebrew/Cellar/librdkafka/1.9.2/include
   export LIBRARY_PATH=/opt/homebrew/Cellar/librdkafka/1.9.2/lib

   # OpenSSL
   export PATH=/opt/homebrew/opt/openssl@3/bin:$PATH

   # Pyenv
   export PYENV_ROOT="$HOME/.pyenv"
   export PATH="$PYENV_ROOT/bin:$PATH"
   eval "$(pyenv init -)"
   # eval "$(pyenv virtualenv-init -)"
   # eval "$(va)" # activate Python virtual env (if applicable)

   # Python
   export PYTHONPATH=.
   export MYPYPATH=.

   # Vault (generated by eng-onboarding check-griphook script)
   export VAULT_ADDR=$(cat /Users/michael.uloth/.griphook/vault-addr)
   export VAULT_AUTH_METHOD=github
   export VAULT_AUTH_CREDS_PATH=/Users/michael.uloth/.griphook/github.pat
   export VAULT_TOKEN=$(cat /Users/michael.uloth/.griphook/vault-token)
   export GITHUB_TOKEN=$(cat $VAULT_AUTH_CREDS_PATH)

   # The next line updates PATH for the Google Cloud SDK.
   if [ -f '/Users/michael.uloth/google-cloud-sdk/path.zsh.inc' ]; then 
   . '/Users/michael.uloth/google-cloud-sdk/path.zsh.inc'; 
   fi

   # The next line enables shell command completion for gcloud.
   if [ -f '/Users/michael.uloth/google-cloud-sdk/completion.zsh.inc' ]; then
   . '/Users/michael.uloth/google-cloud-sdk/completion.zsh.inc'; 
   fi

fi

############
# Starship #
############

export STARSHIP_CONFIG=~/.config/starship/config.toml
eval "$(starship init zsh)"

########
# Vifm #
########

# Open both vifm panes in cwd
alias vifm='vifm . .'

###############
# zsh plugins #
###############

source $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source $(brew --prefix)/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
